---
title: Preview And Speed
description: Placeholder for lookahead, target speed, gain scheduling, and smoothing choices.
keywords: ["controllers", "preview", "speed planning"]
---

## Goal of this controller

We want something that:
- is predictable
- is stable across different corners
- respects curvature-imposed speed limits
- produces smooth commands

This page explains the “baseline improvements” before we introduce style knobs.

<Separator className="my-10" />

## Preview targeting (lookahead)

Choose a target point on the path ahead by distance $L$, then aim toward it.

$$
e_\psi = \text{wrap}\big(\psi_{\text{target}} - \psi\big)
$$

$$
\delta = \text{clip}(k_\delta(v)\,e_\psi,\;-\delta_{\max},\;\delta_{\max})
$$

The key is that $k_\delta$ should depend on speed (gain scheduling).

<div className="my-6 rounded-2xl border bg-muted/20 p-6 text-center text-sm text-muted-foreground">
  [INTERACTIVE PLACEHOLDER] Lookahead slider $L$ on S-bend + heading error plot
</div>

<Separator className="my-10" />

## Curvature → target speed

We use the canonical rule (see Plant & Limits) and track it:

$$
v_t(s)\approx \sqrt{\frac{\mu g}{|\kappa(s)|+\epsilon}}.
$$

Then convert target speed error into longitudinal command:

$$
a_x = \text{clip}\big(k_v(v_t - v),\; -a_{x,\max},\; a_{x,\max}\big)
$$

<div className="my-6 rounded-2xl border bg-muted/20 p-6 text-sm text-muted-foreground">
  [PLOT PLACEHOLDER] Actual speed vs target band through hairpin
</div>

<Separator className="my-10" />

## Gain scheduling (why it matters)

At higher speeds, the same steering gain produces more aggressive yaw response.
A simple schedule example:

$$
k_\delta(v)=\frac{k_0}{1+\alpha v^2}.
$$

<div className="my-6 rounded-2xl border bg-muted/20 p-6 text-sm text-muted-foreground">
  [MINI-DEMO PLACEHOLDER] Toggle: fixed gain vs scheduled gain (show oscillation reduction)
</div>

<Separator className="my-10" />

## Smoothness (rate limiting)

We apply input shaping so commands don’t “snap”:

$$
\delta \leftarrow \text{rate\_limit}(\delta,\dot{\delta}_{\max}),\quad
a_x \leftarrow \text{rate\_limit}(a_x,j_{\max})
$$

<div className="my-6 rounded-2xl border bg-muted/20 p-6 text-sm text-muted-foreground">
  [PLOT PLACEHOLDER] Command traces and jerk metric with/without shaping
</div>

<Separator className="my-10" />

## What this gives us

- Stable path following (less chatter)
- Speed that respects corners
- Smooth commands
- A solid baseline to “stylize” next

